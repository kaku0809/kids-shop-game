<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∞–ª–∞–ª–∞—Ä –î“Ø–∫–µ–Ω—ñ: 1, 2, 5 —Ç–µ“£–≥–µ</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;900&display=swap" rel="stylesheet">
    <style>
        /* --- –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∏–∑–∞–π–Ω --- */
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f8ff; 
            color: #1d3557;
            text-align: center;
            padding: 20px 0;
            margin: 0;
        }
        .game-wrapper {
            max-width: 900px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            border: 8px solid #a8dadc;
        }
        h1 {
            background-color: #457b9d; 
            color: white;
            padding: 15px 0;
            margin: 0;
            font-size: 2.8em;
            letter-spacing: 1px;
            text-shadow: 2px 2px #1d3557;
        }
        .shop-display {
            background-image: url('magazin_fon_2.png'); /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤–∞—à —Ñ–æ–Ω —Å –¥–µ—Ç—å–º–∏ */
            background-size: cover;
            background-position: center bottom;
            height: 450px; 
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
        }
        .price-tag {
            background-color: #fff; 
            border: 4px solid #e63946; 
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 1.8em;
            font-weight: 900;
            position: absolute;
            top: 200px; 
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        .item-list {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
        }
        .item-icon {
            font-size: 3em; 
            margin: 0 5px;
        }
        .total-price {
            color: #e63946;
        }
        .controls-area {
            padding: 25px;
            background-color: #f1faee; 
        }
        .question {
            font-size: 1.8em;
            color: #1d3557; 
            margin-bottom: 20px;
        }
        .selected-coins-display {
            background-color: #fff;
            border: 2px dashed #457b9d;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        #current_sum {
            font-size: 2.2em;
            color: #1d3557;
            font-weight: 900;
        }
        .sum-label {
            font-size: 1.2em;
        }
        .coin-buttons {
            display: flex;
            justify-content: center;
            gap: 30px; 
            margin-bottom: 25px;
        }
        .moneta-btn {
            background: none;
            border: 6px solid transparent; 
            cursor: pointer;
            padding: 0;
            transition: transform 0.2s, border-color 0.3s;
            width: 130px; 
            height: 130px;
            border-radius: 50%; 
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .moneta-btn:hover:not(:disabled) {
            transform: scale(1.1);
            border-color: #457b9d;
        }
        .coin-image {
            width: 100%; 
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .moneta-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .action-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #pay_button {
            background-color: #4CAF50; 
            color: white;
        }
        #pay_button:hover { background-color: #45a049; }

        #reset_button {
            background-color: #ff9800; 
            color: white;
        }
        #reset_button:hover { background-color: #fb8c00; }
        .feedback {
            font-size: 1.4em;
            font-weight: 900;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 8px;
            min-height: 30px;
        }
        .correct { background-color: #b9f6ca; color: #00796b; border: 2px solid #00796b; }
        .error { background-color: #ffcdd2; color: #d32f2f; border: 2px solid #d32f2f; }

        #next_button {
            background-color: #e63946;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 12px;
            font-size: 1.4em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #next_button:hover:not(:disabled) { background-color: #cc2936; }
        #next_button:disabled { background-color: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>

    <div class="game-wrapper">
        <h1>“Æ–ö–Ü –ê–ü–ê–ô–î–´“¢ –ö”®“¢–Ü–õ–î–Ü –î“Æ–ö–ï–ù–Ü</h1>

        <div class="shop-display">
            <div class="price-tag">
                <div class="item-list" id="item_to_buy_list">
                </div>
                <div class="total-price">
                    –ë–∞“ì–∞—Å—ã: <span id="item_price_total">...</span> —Ç–≥
                </div>
            </div>
        </div>

        <div class="controls-area">
            <p id="level" class="question">‚ú® 1-—à—ñ –î–ï“¢–ì–ï–ô: –°–∞—Ç—ã–ø –∞–ª—É</p>
            <div class="feedback" id="feedback"></div>
            
            <div class="selected-coins-display">
                <span class="sum-label">–°–µ–Ω—ñ“£ –∞“õ—à–∞“£:</span>
                <span id="current_sum">0</span> —Ç–≥
            </div>

            <p style="font-size: 1.3em; font-weight: 700;">–¢–∏—ã–Ω–¥–∞—Ä–¥—ã —Ç–∞“£–¥–∞:</p>
            
            <div class="coin-buttons" id="buttons">
                </div>

            <div class="action-buttons">
                <button id="pay_button" class="action-btn" onclick="checkAnswer()">–¢”©–ª–µ—É (–û–ø–ª–∞—Ç–∏—Ç—å)</button>
                <button id="reset_button" class="action-btn" onclick="resetSum()">–°–±—Ä–æ—Å</button>
            </div>

            <button id="next_button" disabled onclick="nextItem()">–ö–µ–ª–µ—Å—ñ —Ç–∞—É–∞—Ä“ì–∞ ”©—Ç—É</button>
            
            <p style="margin-top: 20px;">–ë–æ–Ω—É—Å—Ç—ã“õ —Ç–∞“£–±–∞–ª–∞—Ä: <span id="tokens" style="color: #e63946; font-size: 1.5em;">0</span></p>
        </div>
    </div>

    <audio id="success_sound" src="success.mp3" preload="auto"></audio>
    <audio id="error_sound" src="error.mp3" preload="auto"></audio>

    <script>
        // --- –î–ê–ù–ù–´–ï –ò–ì–†–´: –û–ë–ù–û–í–õ–ï–ù–´ –ú–û–ù–ï–¢–´ –ò –¶–ï–ù–´ –¢–û–í–ê–†–û–í ---
        const MONETALAR = {
            // –ù–û–í–´–ï –ú–û–ù–ï–¢–´: 1, 2, 5 —Ç–µ–Ω–≥–µ
            "moneta_1": { value: 1, imgUrl: "moneta_1.png" }, // –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª moneta_1.png –∑–∞–≥—Ä—É–∂–µ–Ω
            "moneta_2": { value: 2, imgUrl: "moneta_2.png" }, // –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª moneta_2.png –∑–∞–≥—Ä—É–∂–µ–Ω
            "moneta_5": { value: 5, imgUrl: "moneta_5.png" }  // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ moneta_5.png
        };

        const TAUARLAR = [
            // –ù–û–í–´–ï, –ë–û–õ–ï–ï –ù–ò–ó–ö–ò–ï –¶–ï–ù–´: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ 10 —Ç–µ–Ω–≥–µ.
            { name: "–ö”ò–ú–ü–ò–¢", price: 3, icon: "üç¨" }, 
            { name: "–°–ê–†–´ –ë–ê–ù–ê–ù", price: 4, icon: "üçå" }, 
            { name: "–®–ê–†–´", price: 5, icon: "üéà" },
            { name: "“ö–ê–†–ê–ù–î–ê–®", price: 6, icon: "‚úèÔ∏è" },
            { name: "–ö–Ü–®–ö–ï–ù–ï –î–û–ü", price: 7, icon: "ü•é" }, 
            { name: "–û–ô–´–ù–®–´“ö –ú–ê–®–ò–ù–ê", price: 8, icon: "üöó" },
            { name: "–ö–Ü–¢–ê–ü–®–ê", price: 9, icon: "üìñ" }
        ];
        
        // --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø (–ù–µ –º–µ–Ω—è–ª–∏—Å—å) ---
        let bonusTokens = 0;
        let level = 0;
        let currentItems = [];
        let requiredPrice = 0;
        let currentSum = 0; 

        // --- –≠–õ–ï–ú–ï–ù–¢–´ DOM –∏ –ó–í–£–ö–ò (–ù–µ –º–µ–Ω—è–ª–∏—Å—å) ---
        const tokensDisplay = document.getElementById('tokens');
        const levelDisplay = document.getElementById('level');
        const itemToListDisplay = document.getElementById('item_to_buy_list');
        const itemPriceTotalDisplay = document.getElementById('item_price_total');
        const buttonsContainer = document.getElementById('buttons');
        const feedbackDisplay = document.getElementById('feedback');
        const nextButton = document.getElementById('next_button');
        const currentSumDisplay = document.getElementById('current_sum');
        const payButton = document.getElementById('pay_button');
        const successSound = document.getElementById('success_sound');
        const errorSound = document.getElementById('error_sound');

        // --- –õ–û–ì–ò–ö–ê –ò–ì–†–´ (–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è generateTask) ---

        function playSound(audioElement) {
            audioElement.currentTime = 0;
            audioElement.play().catch(e => console.log("Can't play sound:", e));
        }

        function startGame() {
            for (const [key, data] of Object.entries(MONETALAR)) {
                const button = document.createElement('button');
                button.classList.add('moneta-btn');
                button.id = `moneta_${data.value}`; 
                button.onclick = () => addCoin(data.value); 
                button.innerHTML = `<img src="${data.imgUrl}" class="coin-image" alt="${key}">`;
                buttonsContainer.appendChild(button);
            }
            nextItem();
        }

        function addCoin(value) {
            currentSum += value;
            currentSumDisplay.textContent = currentSum;
            if (currentSum >= requiredPrice) {
                 payButton.style.backgroundColor = '#00C853'; 
            }
        }
        
        function resetSum() {
            currentSum = 0;
            currentSumDisplay.textContent = 0;
            feedbackDisplay.textContent = '–ê“õ—à–∞ —Ç–∞“£–¥–∞—É–¥—ã –±–∞—Å—Ç–∞“£—ã–∑.';
            feedbackDisplay.className = 'feedback';
            
            enableButtons(true); 
            document.getElementById('pay_button').disabled = false; 
            document.getElementById('reset_button').disabled = false; 
            
            payButton.style.backgroundColor = '#4CAF50';
        }

        function generateTask() {
            // –£—Ä–æ–≤–µ–Ω—å 1-3: –ü—Ä–æ—Å—Ç–∞—è –ø–æ–∫—É–ø–∫–∞ (–æ–¥–∏–Ω —Ç–æ–≤–∞—Ä)
            if (level <= 3) {
                const item = TAUARLAR[Math.floor(Math.random() * TAUARLAR.length)];
                return [item];
            }
            // –£—Ä–æ–≤–µ–Ω—å 4+: –ü–æ–∫—É–ø–∫–∞ –¥–≤—É—Ö —Ç–æ–≤–∞—Ä–æ–≤ (—Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)
            else {
                let item1, item2;
                do {
                    item1 = TAUARLAR[Math.floor(Math.random() * TAUARLAR.length)];
                    item2 = TAUARLAR[Math.floor(Math.random() * TAUARLAR.length)];
                    // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ —Ü–µ–Ω–∞ –±—É–¥–µ—Ç –Ω–µ –º–µ–Ω—å—à–µ 5 –∏ –Ω–µ –±–æ–ª—å—à–µ 10
                } while (item1.price + item2.price > 10 || item1.price + item2.price < 5); 

                return [item1, item2];
            }
        }
        
        function nextItem() {
            nextButton.disabled = true;
            resetSum();
            
            level++;
            levelDisplay.textContent = `‚ú® ${level}-—à—ñ –î–ï“¢–ì–ï–ô: –°–∞—Ç—ã–ø –∞–ª—É`;

            currentItems = generateTask();
            requiredPrice = currentItems.reduce((sum, item) => sum + item.price, 0);

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏—Ç—Ä–∏–Ω—É
            itemToListDisplay.innerHTML = '';
            let priceString = '';

            currentItems.forEach((item, index) => {
                const itemDiv = document.createElement('span');
                itemDiv.classList.add('item-icon');
                itemDiv.innerHTML = `${item.icon} <span style="font-size: 0.5em; display: block;">(${item.price} —Ç–≥)</span>`;
                itemToListDisplay.appendChild(itemDiv);

                priceString += `${item.price}`;
                if (index < currentItems.length - 1) {
                    const plusSign = document.createElement('span');
                    plusSign.style.fontSize = '2em';
                    plusSign.style.margin = '0 10px';
                    plusSign.textContent = '+';
                    itemToListDisplay.appendChild(plusSign);
                    priceString += ' + ';
                }
            });

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã
            if (currentItems.length === 1) {
                itemPriceTotalDisplay.textContent = requiredPrice;
            } else {
                itemPriceTotalDisplay.textContent = `${priceString} = ${requiredPrice}`;
            }

            if (level > 10) {
                endGame();
            }
        }
        
        function enableButtons(isEnabled) {
            document.querySelectorAll('.moneta-btn').forEach(button => {
                button.disabled = !isEnabled;
            });
        }

        function checkAnswer() {
            let feedbackMessage = "";
            let isCorrect = false;
            
            if (currentSum === requiredPrice) {
                feedbackMessage = `‚úÖ –ö–ï–†–ï–ú–ï–¢! ${currentSum} —Ç–µ“£–≥–µ ‚Äì –¥”ô–ª “õ–∞–∂–µ—Ç—Ç—ñ —Å–æ–º–∞! +1 –¢–∞“£–±–∞!`;
                bonusTokens++;
                isCorrect = true;
                feedbackDisplay.className = 'feedback correct';
                playSound(successSound);
            } 
            else if (currentSum < requiredPrice) {
                feedbackMessage = `‚ùå –ñ–û“ö! ${currentSum} —Ç–µ“£–≥–µ ‚Äî –∂–µ—Ç–∫—ñ–ª—ñ–∫—Å—ñ–∑. “ö–∞–∂–µ—Ç ${requiredPrice} —Ç–≥. –¢–∞“ì—ã —Ç–∏—ã–Ω–¥–∞—Ä “õ–æ—Å—ã“£—ã–∑!`;
                feedbackDisplay.className = 'feedback error';
                playSound(errorSound);
            } 
            else { 
                const change = currentSum - requiredPrice;
                feedbackMessage = `‚ö†Ô∏è –û–π! ${currentSum} —Ç–µ“£–≥–µ ‚Äî —Ç—ã–º –∫”©–ø. “ö–∞–π—Ç–∞—Ä—ã–º (—Å–¥–∞—á–∞) ${change} —Ç–≥. –¢–∞–ø—Å—ã—Ä–º–∞ –æ—Ä—ã–Ω–¥–∞–ª–¥—ã!`;
                
                bonusTokens++;
                isCorrect = true;
                feedbackDisplay.className = 'feedback correct'; 
                playSound(successSound);
            }

            tokensDisplay.textContent = bonusTokens;

            if (isCorrect) {
                document.querySelectorAll('.moneta-btn, #pay_button, #reset_button').forEach(btn => btn.disabled = true);
                nextButton.disabled = false;
            }
        }
        
        function endGame() {
            levelDisplay.textContent = "üéâ –û–ô–´–ù –ê–Ø“ö–¢–ê–õ–î–´!";
            itemToListDisplay.innerHTML = `<span class="item-icon">üèÜ</span>`;
            itemPriceTotalDisplay.textContent = `–°–µ–Ω –±–∞—Ä–ª—ã“õ –¥–µ“£–≥–µ–π–¥–µ–Ω ”©—Ç—Ç—ñ“£!`;
            feedbackDisplay.textContent = `–°–µ–Ω ${bonusTokens} –°–∏“õ—ã—Ä–ª—ã –¢–∞“£–±–∞ –∂–∏–Ω–∞–¥—ã“£! –†–∞—Ö–º–µ—Ç!`;
            nextButton.style.display = 'none';
            document.querySelectorAll('.action-buttons, .coin-buttons').forEach(el => el.style.display = 'none');
        }

        window.onload = startGame;
    </script>
</body>
</html>
